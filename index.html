<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Promo Shopee Hari Ini</title>

  <!-- Icon -->
  <link rel="icon" href="icon.jpg">
  <link rel="apple-touch-icon" href="icon.jpg">
  <link rel="apple-touch-icon" sizes="180x180" href="icon.jpg">

  <!-- Manifest PWA -->
  <link rel="manifest" href="manifest.json">

  <!-- iOS PWA meta -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Promo Shopee">

  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    .popup {
      display: none;
      position: fixed; top:0; left:0; width:100%; height:100%;
      background: rgba(0,0,0,0.5);
      justify-content:center; align-items:center;
    }
    .popup-content {
      background:#fff; padding:20px; border-radius:10px; max-width:320px; text-align:left;
    }
    #promoBtn, #shopeeBtn {
      border:none; border-radius:8px; font-weight:bold; cursor:pointer;
      width:100%; padding:15px; font-size:18px; margin-top:10px;
    }
    #promoBtn { background:#ee4d2d; color:#fff; }
    #shopeeBtn { background:#ff6600; color:#fff; }
    label { display:flex; align-items:center; margin-top:10px; cursor:pointer; }
    input[type=checkbox] { margin-right:8px; }
  </style>

  <!-- Redirect otomatis PWA Android ke web affiliate -->
  <script>
    setTimeout(() => {
      if (window.matchMedia('(display-mode: standalone)').matches) {
        window.location.replace("https://s.shopee.co.id/4q9124B5Il?share_channel_code=1");
      }
    }, 50);
  </script>

</head>
<body>

<h1>Promo Shopee Pilihan Hari Ini</h1>
<p>Belanja lewat tombol di bawah untuk mendapatkan promo resmi Shopee. Harga sama, kami mendapat komisi tanpa biaya tambahan.</p>

<!-- Popup edukasi -->
<div id="popup" class="popup">
  <div class="popup-content">
    <p>Pasang halaman ini ke layar utama supaya selalu dapat promo terbaru!</p>
    <button id="promoBtn">Pasang ke Home Screen</button>
    <label><input type="checkbox" id="dontShow"> Jangan tampilkan lagi</label>
  </div>
</div>

<script>
let deferredPrompt;
const popup = document.getElementById('popup');
const promoBtn = document.getElementById('promoBtn');
const dontShow = document.getElementById('dontShow');

// Popup hanya tampil jika user belum sembunyikan dan bukan PWA
if (!localStorage.getItem('hidePwaPopup') && !window.matchMedia('(display-mode: standalone)').matches) {

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    popup.style.display = 'flex';
  });

  promoBtn.addEventListener('click', async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
      popup.style.display = 'none';
    }
  });

  dontShow.addEventListener('change', () => {
    if (dontShow.checked) localStorage.setItem('hidePwaPopup', 'true');
  });

}
</script>

<h2>Promo Pilihan Hari Ini</h2>
<a href="https://s.shopee.co.id/4q9124B5Il?share_channel_code=1" target="_blank">
  <img src="logo.jpg" alt="Promo" style="width:200px; margin-top:15px;">
</a>

<!-- Tombol Buka Shopee App -->
<button id="shopeeBtn" onclick="openShopeeApp()">Buka di Shopee App</button>

<script>
function openShopeeApp() {
  const intentURL = "intent://s.shopee.co.id/4q9124B5Il?share_channel_code=1#Intent;scheme=https;package=com.shopee.id;end";
  const webURL = "https://s.shopee.co.id/4q9124B5Il?share_channel_code=1";

  window.location = intentURL;

  setTimeout(() => {
    window.location = webURL;
  }, 500);
}
</script>

</body>
</html>
